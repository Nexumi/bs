!function(){"use strict";let t=document.getElementsByClassName("lds")[0],e=[];window.apiShort=function(t){!function t(i){function n(){let t=document.getElementsByClassName("popuptext")[0];for(let i of(t.classList.remove("removed"),t.classList.remove("hide"),t.classList.add("show"),e))clearTimeout(i);e.length=0,e.push(setTimeout(function(){t.classList.remove("show"),t.classList.add("hide"),e.push(setTimeout(function(){t.classList.add("removed"),e.length=0},1e3))},3e3))}if(i==window.location.origin+"?"){navigator.clipboard.writeText(window.location.origin),n();return}if(!window.navigator.onLine){navigator.clipboard.writeText(i),n();return}let s={method:"POST",body:JSON.stringify({url:i})};if(navigator.clipboard.write){let a=new ClipboardItem({"text/plain":fetch("https://api.short.jpkit.us/",s).then(e=>{if(409===e.status)t(i);else{if(200===e.status)return e.text();navigator.clipboard.writeText(i),n()}}).then(t=>new Blob([t],{type:"text/plain"}))});navigator.clipboard.write([a]),n()}else fetch("https://api.short.jpkit.us/",s).then(e=>{if(409===e.status)t(i);else{if(200===e.status)return e.text();navigator.clipboard.writeText(i),n()}}).then(t=>{navigator.clipboard.writeText(t),n()})}(t)},window.apiExpandShort=function(t){window.navigator.onLine||function t(e){let i=e.split("/");fetch(`https://api.short.jpkit.us?domain=${i[i.length-2]}&path=${i[i.length-1]}`).then(t=>{if(200===t.status)return t.text()}).then(t=>{parseURL(t)})}(t)};let i=t=>new Promise((e,i)=>{let n=new FileReader;n.readAsDataURL(t),n.onload=()=>e(n.result),n.onerror=i});window.apiReceipt=function(){window.navigator.onLine&&i(document.getElementById("file").files[0]).then(e=>{t.classList.remove("hidden"),fetch("https://api.mindee.jpkit.us/",{method:"POST",body:JSON.stringify({document:e})}).then(t=>t.json()).then(e=>{scannedReceipt({products:(e=e.document.inference.prediction).line_items.map(({description:t,total_amount:e})=>({description:t,total:e})),tax:e.total_tax.value,tip:e.tip.value}),t.classList.add("hidden")}).catch(e=>{i(document.getElementById("file").files[0]).then(e=>{t.classList.remove("hidden"),fetch("https://api.veryfi.jpkit.us/",{method:"POST",body:JSON.stringify({file_data:e})}).then(t=>t.json()).then(e=>{scannedReceipt({products:e.line_items,tax:e.tax,tip:e.tip}),fetch("https://api.veryfi.jpkit.us/",{method:"DELETE",body:JSON.stringify({document_id:e.id})}).then(()=>{t.classList.add("hidden")})}).catch(e=>{alert("Receipt scanning failed.\nProbably hit the API limit for the month."),t.classList.add("hidden")})})})})}}();