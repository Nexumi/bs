"use strict";function person(e,t,a){this.name=e,this.pritem=[[t,a]]}var column=document.getElementsByClassName("column"),names=column[0],prices=column[1],items=column[2],split=document.getElementsByClassName("split"),sitems=split[0],sprices=split[1],exclude=split[2],extra=document.getElementsByClassName("extra")[0],result=document.getElementsByClassName("result")[0];function getParams(){let urlParams=new URLSearchParams(window.location.search),params=["names","prices","items","sitems","sprices","exclude","extra"];for(var i=0;i<params.length;i++){var param=params[i];try{var get=eval(urlParams.get(param))}catch(tobe){continue}if(null!=get)for(var inputs=eval(param+'.getElementsByTagName("input")'),j=0;j<get.length;j++)inputs[j].value=get[j],i<3&&void 0==inputs[j+1]?createInput():i<6&&void 0==inputs[j+1]&&createSplit()}}function share(){var link="?",yes=!1;let params=["names","prices","items","sitems","sprices","exclude","extra"];for(var i=0;i<params.length;i++){for(var param=params[i],inputs=eval(param+".getElementsByTagName('input')"),makeParam=[],j=0;j<inputs.length;j++)makeParam.push("%22"+inputs[j].value.replaceAll(" ","%20")+"%22");for(var j=makeParam.length-1;j>=0;j--)if(6==makeParam[j].length)makeParam.pop();else break;0!=makeParam.length&&(yes?link+="&":yes=!0,link+=param+"=%5B"+makeParam+"%5D")}link=1==link.length?"":link;var end=window.location.href.indexOf("?");link=(-1!=end?window.location.href.substring(0,end):window.location.href)+link,navigator.clipboard.writeText(link)}function createInput(){var e=document.createElement("input");e.setAttribute("type","text"),names.appendChild(e);var t=document.createElement("input");t.setAttribute("type","text"),prices.appendChild(t);var a=document.createElement("input");a.setAttribute("type","text"),items.appendChild(a)}function destroyInput(e=nameInputs.length-1){var t=names.getElementsByTagName("input"),a=prices.getElementsByTagName("input"),n=items.getElementsByTagName("input");t[e].remove(),a[e].remove(),n[e].remove()}function deleteHbr(){for(var e=1;e<=6;e++)for(var t=result.getElementsByTagName("h"+e),a=t.length,n=0;n<a;n++)t[0].remove();for(var l=result.getElementsByTagName("br"),r=l.length,e=0;e<r;e++)l[0].remove()}function peopleFind(e,t){for(var a=0;a<e.length;a++)if(e[a].name==t)return a;return -1}function itemFind(e,t){for(var a=0;a<e.length;a++)if(e[a][1]==t)return a;return -1}function peopleCreate(){for(var peep=[],nameInputs=names.getElementsByTagName("input"),priceInputs=prices.getElementsByTagName("input"),itemInputs=items.getElementsByTagName("input"),i=0;i<nameInputs.length;i++)try{var name=nameInputs[i].value.replace(/\s+/g," ").trim(),price=priceInputs[i].value.replace(/\s+/g," ").trim(),item=itemInputs[i].value.replace(/\s+/g," ").trim();if(nameInputs[i]!=document.activeElement&&priceInputs[i]!=document.activeElement&&itemInputs[i]!=document.activeElement&&(nameInputs[i].value=name,priceInputs[i].value=price,itemInputs[i].value=item),price=eval(price),!isNaN(price)){priceInputs[i]!=document.activeElement&&(priceInputs[i].value=price);var find=peopleFind(peep,name);if(-1!=find){var pritem=peep[find].pritem,pfit=itemFind(pritem,item);-1!=pfit?pritem[pfit][0]+=price:pritem.push([price,item])}else{var persun=new person(name,price,item);peep.push(persun)}}}catch(ignore){}for(var i=0;i<nameInputs.length-1;)0==nameInputs[i].value.length&&nameInputs[i]!=document.activeElement&&0==priceInputs[i].value.length&&priceInputs[i]!=document.activeElement&&0==itemInputs[i].value.length&&itemInputs[i]!=document.activeElement?destroyInput(i):i++;return(0!=nameInputs[nameInputs.length-1].value.length||0!=priceInputs[priceInputs.length-1].value.length||0!=itemInputs[itemInputs.length-1].value.length)&&createInput(),peep}function createSplit(){var e=document.createElement("input");e.setAttribute("type","text"),sitems.appendChild(e);var e=document.createElement("input");e.setAttribute("type","text"),sprices.appendChild(e);var e=document.createElement("input");e.setAttribute("type","text"),exclude.appendChild(e)}function destroySplit(e=nameInputs.length-1){var t=sitems.getElementsByTagName("input"),a=sprices.getElementsByTagName("input"),n=exclude.getElementsByTagName("input");t[e].remove(),a[e].remove(),n[e].remove()}function splitCreate(peep){for(var itemInputs=sitems.getElementsByTagName("input"),priceInputs=sprices.getElementsByTagName("input"),excludeInputs=exclude.getElementsByTagName("input"),i=0;i<itemInputs.length;i++)try{for(var item=itemInputs[i].value.replace(/^\s+|\s+$/gm," ").trim(),price=eval(priceInputs[i].value),excludes=excludeInputs[i].value.split(","),j=0;j<excludes.length;j++)excludes[j]=excludes[j].replace(/^\s+|\s+$/gm," ").trim(),0==excludes[j].length&&excludes.pop(j);if(!isNaN(price)){priceInputs[i]!=document.activeElement&&(priceInputs[i].value=price),item+=" [Split]",price/=peep.length-excludes.length;for(var j=0;j<peep.length;j++)excludes.includes(peep[j].name)||peep[j].pritem.push([price,item])}}catch(ignore){}for(var i=0;i<itemInputs.length-1;)0==itemInputs[i].value.length&&itemInputs[i]!=document.activeElement&&0==priceInputs[i].value.length&&priceInputs[i]!=document.activeElement&&0==excludeInputs[i].value.length&&excludeInputs[i]!=document.activeElement?destroySplit(i):i++;(0!=itemInputs[itemInputs.length-1].value.length||0!=priceInputs[priceInputs.length-1].value.length||0!=excludeInputs[excludeInputs.length-1].value.length)&&createSplit()}function costH(peep){var tax,tip,ex=extra.getElementsByTagName("input");try{tax=eval(ex[0].value)||0}catch(what){tax=0}try{tip=eval(ex[1].value)||0}catch(what){tip=0}0!=tax&&ex[0]!=document.activeElement&&(ex[0].value=tax),0!=tip&&ex[1]!=document.activeElement&&(ex[1].value=tip),tax/=100;for(var subtotal=0,i=0;i<peep.length;i++)for(var pricy=peep[i].pritem,j=0;j<pricy.length;j++){var price=pricy[j][0];isNaN(price)||(subtotal+=price)}tax*=subtotal;var total=subtotal+tax,trueTotal=total+tip,h3=document.createElement("h3");h3.innerText="Subtotal: $"+subtotal.toFixed(2),result.appendChild(h3),(h3=document.createElement("h3")).innerText="Tax: $"+tax.toFixed(2),result.appendChild(h3),(h3=document.createElement("h3")).innerText="Total: $"+total.toFixed(2),result.appendChild(h3),(h3=document.createElement("h3")).innerText="Tip: $"+tip.toFixed(2),result.appendChild(h3),(h3=document.createElement("h3")).innerText="True Total: $"+trueTotal.toFixed(2),result.appendChild(h3);var br=document.createElement("br");result.appendChild(br)}function individualH(peep){var tax,tip,ex=extra.getElementsByTagName("input");try{tax=eval(ex[0].value)/100||0}catch(what){tax=0}try{tip=eval(ex[1].value)/peep.length||0}catch(what){tip=0}for(var i=0;i<peep.length;i++)if(0!=peep[i].name.length){for(var price=0,pricy=peep[i].pritem,j=0;j<pricy.length;j++){var subprice=pricy[j][0];isNaN(subprice)||(price+=subprice)}var prat=price*tax,h3=document.createElement("h3");h3.innerText=peep[i].name+": $"+(price+prat+tip).toFixed(2),result.appendChild(h3);var h5=document.createElement("h5");h5.innerText="  Tax: $"+prat.toFixed(2),result.appendChild(h5);var h5=document.createElement("h5");h5.innerText="  Tip: $"+tip.toFixed(2),result.appendChild(h5);for(var j=0;j<pricy.length;j++){var subitem=pricy[j];isNaN(subitem[0])||0==subitem[1].length||((h5=document.createElement("h5")).innerText="  "+subitem[1]+": $"+subitem[0].toFixed(2),result.appendChild(h5))}}}function calculate(){deleteHbr();var e=peopleCreate();splitCreate(e),costH(e),individualH(e)}createSplit(),createInput(),getParams(),document.getElementById("share").addEventListener("click",share),setInterval(calculate);